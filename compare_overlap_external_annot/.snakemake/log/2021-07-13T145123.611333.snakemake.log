Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	1	calculate_train_test_ROC_precall_against_bg
	2

[Tue Jul 13 14:51:25 2021]
rule calculate_train_test_ROC_precall_against_bg:
    input: ../../model_analysis/K562_hg19/all_mark_model/state_25/full_model/segment_based_on_entropy/overlap_crispr_mpra/fg_against_bg/train_overlap_against_bg.txt, ../../model_analysis/K562_hg19/all_mark_model/state_25/full_model/segment_based_on_entropy/overlap_crispr_mpra/fg_against_bg/test_overlap_against_bg.txt, ../../model_analysis/K562_hg19/three_mark_model/state_8/full_model/segment_based_on_entropy/overlap_crispr_mpra/fg_against_bg/train_overlap_against_bg.txt, ../../model_analysis/K562_hg19/three_mark_model/state_8/full_model/segment_based_on_entropy/overlap_crispr_mpra/fg_against_bg/test_overlap_against_bg.txt, ../../data/hg19/K562/roadmap_published_chromHMM/25_state/overlap_crispr_mpra/fg_against_bg/train_overlap_against_bg.txt, ../../data/hg19/K562/roadmap_published_chromHMM/25_state/overlap_crispr_mpra/fg_against_bg/test_overlap_against_bg.txt, ../../model_analysis/K562_hg19/simple_rules_from_natalie/overlap_crispr_mpra/fg_against_bg/train_overlap_against_bg.txt, ../../model_analysis/K562_hg19/simple_rules_from_natalie/overlap_crispr_mpra/fg_against_bg/test_overlap_against_bg.txt
    output: ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_Fulco19_significant_DE_G_ST6a.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_gasperini19_altScale_664_enhancerGenePairs_ST2B.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_gasperini19_pilot_145_EnhancerGenePairs_ST1B.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S1_discovery_K562_sgrna.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S2_discovery_K562_bin2.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S3_discovery_K562_bin3.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S5_discovery_K562_dhs.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S6_validation_K562_sgrna.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S7_validation_K562_bin2.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S8_validation_K562_bin3.txt
    jobid: 3

[Tue Jul 13 14:51:25 2021]
Error in rule calculate_train_test_ROC_precall_against_bg:
    jobid: 3
    output: ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_Fulco19_significant_DE_G_ST6a.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_gasperini19_altScale_664_enhancerGenePairs_ST2B.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_gasperini19_pilot_145_EnhancerGenePairs_ST1B.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S1_discovery_K562_sgrna.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S2_discovery_K562_bin2.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S3_discovery_K562_bin3.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S5_discovery_K562_dhs.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S6_validation_K562_sgrna.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S7_validation_K562_bin2.txt, ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg/auc_klann21_S8_validation_K562_bin3.txt
    shell:
        
		model_type="all_mark_model three_mark_model"
		all_mark_max_nState=25
		three_mark_max_nState=8
		overlap_folder_list=""
		model_name_list=""
		num_model=0
		for ns in `seq 25 ${all_mark_max_nState}`
		do
			this_overlap_folder=../../model_analysis/K562_hg19/all_mark_model/state_${ns}/full_model/segment_based_on_entropy/overlap_crispr_mpra/fg_against_bg
			overlap_folder_list="$overlap_folder_list $this_overlap_folder"
			this_model_name="M13_S${ns}"
			model_name_list="$model_name_list $this_model_name"
			num_model=$(( $num_model + 1 ))
		done
		for ns in `seq 8 ${three_mark_max_nState}`
		do
			this_overlap_folder=../../model_analysis/K562_hg19/three_mark_model/state_${ns}/full_model/segment_based_on_entropy/overlap_crispr_mpra/fg_against_bg
			overlap_folder_list="$overlap_folder_list $this_overlap_folder"
			this_model_name="M3_S${ns}"
			model_name_list="$model_name_list $this_model_name"
			num_model=$(( $num_model + 1 ))
		done
		num_model=$(( $num_model + 2 ))
		roadmap_overlap_folder=../../data/hg19/K562/roadmap_published_chromHMM//25_state/overlap_crispr_mpra/fg_against_bg
		simple_rules_overlap_folder=../../model_analysis/K562_hg19/simple_rules_from_natalie/overlap_crispr_mpra/fg_against_bg
		overlap_folder_list="$overlap_folder_list $roadmap_overlap_folder $simple_rules_overlap_folder"
		model_name_list="$model_name_list roadmap_S25 simpleRules_S3" 
		python ./scripts/calculate_roc_enrichment_against_bg_train_test.py $num_model ../../model_analysis/K562_hg19/compare_models_recover_crispr_mpra/entropy_stratified/fg_against_bg ${overlap_folder_list} ${model_name_list}
		
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /gstore/home/vuh6/source/compare_overlap_external_annot/.snakemake/log/2021-07-13T145123.611333.snakemake.log
